# IoT4I Cloud Shield Toolkit

This shield template shows the structure of a shield that is used to build the IoT for Insurance shields. The template contains the following operators:

 ![alt text](./images/shield-template.png "Shield Template Operators")

- Annotated Source Operator:

  A Message Hub source operator that abstracts the details for connecting to IBM Message Hub. This source operator listens to the annotated events that are generated by the TransformerJob. The output of this operator is `stream<rstring userId, rstring key, rstring message>` where userId is the id of the user who owns the devices which sends the events. The key contains the IBM IoT platform topic. Finally the message is the real event payload.


- Filter Operator:

 An **optional** operator which can be used to filter events based on any condition that the shield developer wants. It is an entry condition operator to make sure that only valid events are passed into the shield.


- Check Activation Operator:

 An **optional** iot4i operator which can be used by shield developer to filter events if the user hasn't activated this shield.  
 
 
- Shield Specific Operators:

  Sshield developers can add their own shield specific operators. The output of his operator(s) should match the hazard schema:

  ```
  Type Hazard = rstring userId, list<rstring> rawEvents, rstring actionParams ;
   ```
   Where:

  **userId**: The id of the user who owns the device that sends the events. The userId is provided by the source operator.
  **rawEvents**: A list of all events that caused the hazard.
  **actionParams**: An object contains all extra information that is required for the external action.


- SubmitHazards Sink

 An IoT for Insurance sink operator that prepares hazards and writes them to Message Hub.




 The complete SPl code of the template is [here](./com.ibm.iot4i.shields.template/ShieldTemplate.spl)
